# ML Inference Service

–¶–µ–π –ø—Ä–æ—î–∫—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä—É—î —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —Å–µ—Ä–≤—ñ—Å—É –¥–ª—è inference –º–æ–¥–µ–ª–µ–π PyTorch (TorchScript) –Ω–∞ –ø—Ä–∏–∫–ª–∞–¥—ñ MobileNetV2 –¥–ª—è –∫–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –∑–æ–±—Ä–∞–∂–µ–Ω—å. –°–µ—Ä–≤—ñ—Å —É–ø–∞–∫–æ–≤–∞–Ω–∏–π —É Docker –¥–ª—è –∑—Ä—É—á–Ω–æ–≥–æ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è.


---

## –û—Å–æ–±–ª–∏–≤–æ—Å—Ç—ñ
- –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è **TorchScript** –¥–ª—è –µ–∫—Å–ø–æ—Ä—Ç—É –º–æ–¥–µ–ª—ñ —Ç–∞ —à–≤–∏–¥–∫–æ–≥–æ inference.
- –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ **ImageNet classes** –¥–ª—è —ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü—ñ—ó —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤.
- **Docker multi-stage build**:
  - **ml-fatetest**: –ø–æ–≤–Ω–∞ —Å–µ—Ä–µ–¥–∞ –¥–ª—è —Ä–æ–∑—Ä–æ–±–∫–∏ —Ç–∞ —Ç–µ—Å—Ç—ñ–≤ (20+ GB)
  - **ml-slimtest**: –º—ñ–Ω—ñ–º–∞–ª—å–Ω–∞ slim –≤–µ—Ä—Å—ñ—è –¥–ª—è production (8+ GB)
- –ú–æ–∂–ª–∏–≤—ñ—Å—Ç—å –∑–∞–ø—É—Å–∫—É inference –Ω–∞ –±—É–¥—å-—è–∫–æ–º—É –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—ñ –±–µ–∑ –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ—Å—Ç—ñ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–≥–æ –∫–æ–ø—ñ—é–≤–∞–Ω–Ω—è –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä.
- CPU-only inference, –≥–æ—Ç–æ–≤–∏–π –¥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —É production.

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ—î–∫—Ç—É

lesson-3/

- ‚îú‚îÄ‚îÄ inference.py - –°–∫—Ä–∏–ø—Ç —ñ–Ω—Ñ–µ—Ä–µ–Ω—Å—É (—Ç–æ–ø-3 –∫–ª–∞—Å–∏)
- ‚îú‚îÄ‚îÄ export_model.py - –ï–∫—Å–ø–æ—Ä—Ç mobilenet_v2 ‚Üí TorchScript
- ‚îú‚îÄ‚îÄ model.pt - –ó–±–µ—Ä–µ–∂–µ–Ω–∞ TorchScript –º–æ–¥–µ–ª—å
- ‚îú‚îÄ‚îÄ imagenet_classes.json - –ú–∞–ø–∞ —ñ–Ω–¥–µ–∫—Å ‚Üí –∫–ª–∞—Å
- ‚îú‚îÄ‚îÄ Dockerfile.fat - Fat –æ–±—Ä–∞–∑
- ‚îú‚îÄ‚îÄ Dockerfile.slim - Multi-stage slim –æ–±—Ä–∞–∑
- ‚îú‚îÄ‚îÄ install_dev_tools.sh - –°–∫—Ä–∏–ø—Ç –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π
- ‚îú‚îÄ‚îÄ comparison.txt - –ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è fat vs slim
- ‚îî‚îÄ‚îÄ README.md

---

## üõ† 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ñ–≤

    bash install_dev_tools.sh

–°–∫—Ä–∏–ø—Ç install_dev_tools.sh:
- –≤—Å—Ç–∞–Ω–æ–≤–ª—é—î Docker (—è–∫—â–æ –Ω–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ)
- –≤—Å—Ç–∞–Ω–æ–≤–ª—é—î Docker Compose (—è–∫—â–æ –Ω–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ)
- –ø–µ—Ä–µ–≤—ñ—Ä—è—î Python 3.9+
- –≤—Å—Ç–∞–Ω–æ–≤–ª—é—î PyTorch, TorchVision, Pillow (—è–∫—â–æ –Ω–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ)
- –ª–æ–≥ —É install.log



## üìä 6. –ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è –æ–±—Ä–∞–∑—ñ–≤ (comparison.txt –∞–±–æ report.md)


## üöÄ 2. –ï–∫—Å–ø–æ—Ä—Ç –º–æ–¥–µ–ª—ñ

    python3 export_model.py
    –ü—ñ—Å–ª—è –∑–∞–ø—É—Å–∫—É —Å—Ç–≤–æ—Ä—é—î—Ç—å—Å—è —Ñ–∞–π–ª:

## üß™ 3. –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è inference.py –ª–æ–∫–∞–ª—å–Ω–æ
    python3 inference.py path/to/image.jpg

## üê≥ 4. –ü–æ–±—É–¥–æ–≤–∞ Docker –æ–±—Ä–∞–∑—ñ–≤
Fat –æ–±—Ä–∞–∑

    docker build -f Dockerfile.fat -t ml-fatetest .

Slim –æ–±—Ä–∞–∑ (multi-stage)

    docker build -f Dockerfile.slim -t ml-slimtest .

## ‚ñ∂Ô∏è 5. –ó–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ–≤

    docker run --rm -v $(pwd)/image.jpg:/image.jpg ml-fatetest /image.jpg
    docker run --rm -v $(pwd)/image.jpg:/image.jpg ml-slimtest /image.jpg

## üìä 6. –ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è –æ–±—Ä–∞–∑—ñ–≤ (comparison.txt –∞–±–æ report.md)

–ü–æ—Ä—ñ–≤–Ω—é—î–º–æ:
- —Ä–æ–∑–º—ñ—Ä –æ–±—Ä–∞–∑—ñ–≤
- –∫—ñ–ª—å–∫—ñ—Å—Ç—å —à–∞—Ä—ñ–≤
- –∑–∞–π–≤—ñ —É—Ç–∏–ª—ñ—Ç–∏ —É fat-–æ–±—Ä–∞–∑—ñ
- –≤–∞—Ä—ñ–∞–Ω—Ç–∏ –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó (distroless, cpu-only torch, quantization —Ç–æ—â–æ)



